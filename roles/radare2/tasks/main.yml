---

- name: Include variables.
  ansible.builtin.include_vars: "main.yml"

- name: Install dependencies.
  ansible.builtin.apt:
    name: "{{ deps_packages }}"
    state: present
    update_cache: yes
  register: pkg_result
  until: pkg_result is success

- name: Clone github project.
  ansible.builtin.git:
    repo: "{{ git_url }}"
    dest: "{{ dir_path }}"
    update: yes

- name: Configure build target
  ansible.builtin.shell: ./configure --prefix=/usr/local --with-rpath
  args:
    chdir: "{{ dir_path }}"

- name: Make target
  community.general.make:
    chdir: "{{ dir_path }}"
    target: ""

- name: Make install target
  community.general.make:
    chdir: "{{ dir_path }}"
    target: install

